{% extends 'arbol_item.html' %}
{% load staticfiles %}



{% block content %}

<div class="title_right" style="background-color:#ccc">
    <div class="x_title">

        <a href='/tramites/listado'><strong>LISTADO</strong></a> --
        <strong>TRAMITE</strong>

    </div>
</div>

<div class="clearfix"></div>
<form id="frm" method="post" data-parsley-validate class="form-horizontal form-label-left">{% csrf_token %}
<div class="row">
    <div class="col-md-6 col-sm-6 col-xs-12">
        <div class="x_panel">
            <div class="x_title">
                <h2><strong>DETALLE DEL TRAMITE</strong></h2>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                {% for msg in messages %}
                    <strong>{{ msg }}</strong>
                    <br>
                {% endfor %}
                <br>
                <div class="form-group">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <label for="fullname" class="col-md-12 col-sm-12 col-xs-12">Cliente</label>
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <select class="select2_single form-control" tabindex="-1">
                                <option value="">Seleccione un cliente</option>
                                {% for cliente in personas %}
                                    <option value="{{ cliente.persona.id }}">{{ cliente }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <label for="fullname" class="col-md-12 col-sm-12 col-xs-12">Tipo de Tr√°mite</label>
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <select id="id_tipo" name="tipo" class="select2_single form-control">
                                <option value="">---------</option>
                                {% for tipo in tipos_tramites %}
                                    <option value="{{ tipo.id }}" {% if tipo.id == tramite.tipo.id %} selected {% endif %}>{{ tipo }}</option>
                                {% endfor %}
                            </select>
                        </div>{{ form.tipo.errors }}
                    </div>
                </div>

                <div class="form-group">
                    <input  type="text" placeholder="click to show datepicker"  id="example1">
                </div>

                <div class="form-group">
                    <div class="col-md-6 col-sm-6 col-xs-12">
                        <label for="fullname" class="col-md-12 col-sm-12 col-xs-12">Fecha de Turno</label>
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            {{ form.fecha_inicio }}
                            <span class="fa fa-calendar form-control-feedback right" aria-hidden="true"></span>
                        </div>{{ form.fecha_inicio.errors }}
                    </div>
                    <div class="col-md-6 col-sm-6 col-xs-12">
                        <label for="fullname" class="col-md-12 col-sm-12 col-xs-12">Fecha Alarma</label>
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            {{ form.fecha_alarma }}
                            <span class="fa fa-calendar form-control-feedback right" aria-hidden="true"></span>
                        </div>{{ form.fecha_alarma.errors }}
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <label for="id_estado">Estado:</label>
                            {{ form.estado }}
                        </div>{{ form.estado.errors }}
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <label for="id_observaciones"  class="col-md-12 col-sm-12 col-xs-12">Observaciones:</label>
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            {{ form.observaciones }}
                        </div>{{ form.observaciones.errors }}
                    </div>
                </div>
                <br>
                <div class="form-group">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <button type="button" id="btnGuardar" class="btn btn-success">Guardar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-sm-6 col-xs-12">
        <div class="x_panel">
            <div class="x_title">
                <h2><strong>REQUISITOS NECESARIOS</strong></h2>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                <input type="hidden" id="id_requisitos_presentados" name="requisitos_presentados" value=""/>

                {% for opcion in requisitos %}
                    <div class="checkbox" id="check_requisitos">
                        <label>
                            <input type="checkbox" class="flat" id="id_{{ opcion }}" name="{{ opcion.requisito }}" value="0" {% if  opcion.presentado %} checked="checked" {% endif %}>
                            {{ opcion.requisito }}
                        </label>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
</form>

<script>
    var frm = document.getElementById('frm');
    var requisito = "";

    $('#btnGuardar').click(function(){

        $('div#check_requisitos input[type=checkbox]').each(function() {
           if ($(this).is(":checked")) {
               requisito += $(this).attr('name') + '#1|';
           } else {
               requisito += $(this).attr('name') + '#0|';
           }
        });

        $('#id_requisitos_presentados').val(requisito.slice(0,-1));

        frm.submit();
    });
</script>



{% endblock %}